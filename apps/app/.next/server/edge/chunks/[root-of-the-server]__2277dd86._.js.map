{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/apps/app/src/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n\nexport function middleware(request: NextRequest) {\n  const url = request.nextUrl.clone()\n  const hostname = request.headers.get('host') || ''\n\n  // 개발 환경에서는 미들웨어 비활성화\n  if (hostname.includes('localhost') || hostname.includes('127.0.0.1')) {\n    return NextResponse.next()\n  }\n\n  // 도메인별 라우팅 처리\n  switch (hostname) {\n    case 'talksign.co.kr':\n      // 랜딩 페이지 도메인: 오직 마케팅 페이지만 허용\n      const authRoutes = ['/auth', '/login', '/signup', '/signin']\n      const appRoutes = ['/dashboard', '/documents', '/finance', '/schedule', '/customers']\n\n      // 인증 관련 라우트는 accounts 도메인으로 리다이렉트\n      if (authRoutes.some(route => url.pathname.startsWith(route))) {\n        url.hostname = 'accounts.talksign.co.kr'\n        url.pathname = url.pathname.replace('/auth', '') // /auth 접두사 제거\n        return NextResponse.redirect(url)\n      }\n\n      // 앱 관련 라우트는 app 도메인으로 리다이렉트\n      if (appRoutes.some(route => url.pathname.startsWith(route))) {\n        url.hostname = 'app.talksign.co.kr'\n        return NextResponse.redirect(url)\n      }\n\n      // 랜딩 페이지 허용 경로: /, /pricing, /features, /about, /contact\n      const allowedLandingPaths = ['/', '/pricing', '/features', '/about', '/contact', '/api']\n      if (!allowedLandingPaths.some(path => url.pathname.startsWith(path))) {\n        // 허용되지 않은 경로는 홈으로 리다이렉트\n        url.pathname = '/'\n        return NextResponse.redirect(url)\n      }\n      break\n\n    case 'accounts.talksign.co.kr':\n      // 인증 도메인: 로그인/회원가입만 허용\n      const allowedAuthPaths = ['/', '/login', '/signup', '/signin', '/forgot-password', '/reset-password', '/api']\n      if (!allowedAuthPaths.some(path => url.pathname.startsWith(path))) {\n        // 허용되지 않은 경로는 로그인 페이지로 리다이렉트\n        url.pathname = '/login'\n        return NextResponse.redirect(url)\n      }\n      break\n\n    case 'app.talksign.co.kr':\n      // 앱 도메인: 모든 앱 기능 허용\n      // 인증되지 않은 사용자의 경우 accounts 도메인으로 리다이렉트는 각 페이지에서 처리\n      return NextResponse.next()\n\n    default:\n      // 알 수 없는 도메인은 메인 랜딩 페이지로 리다이렉트\n      url.hostname = 'talksign.co.kr'\n      url.pathname = '/'\n      return NextResponse.redirect(url)\n  }\n\n  return NextResponse.next()\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */\n    '/((?!_next/static|_next/image|favicon.ico).*)',\n  ],\n}"],"names":[],"mappings":";;;;AAAA;AAAA;;AAGO,SAAS,WAAW,OAAoB;IAC7C,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;IACjC,MAAM,WAAW,QAAQ,OAAO,CAAC,GAAG,CAAC,WAAW;IAEhD,qBAAqB;IACrB,IAAI,SAAS,QAAQ,CAAC,gBAAgB,SAAS,QAAQ,CAAC,cAAc;QACpE,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC1B;IAEA,cAAc;IACd,OAAQ;QACN,KAAK;YACH,6BAA6B;YAC7B,MAAM,aAAa;gBAAC;gBAAS;gBAAU;gBAAW;aAAU;YAC5D,MAAM,YAAY;gBAAC;gBAAc;gBAAc;gBAAY;gBAAa;aAAa;YAErF,kCAAkC;YAClC,IAAI,WAAW,IAAI,CAAC,CAAA,QAAS,IAAI,QAAQ,CAAC,UAAU,CAAC,SAAS;gBAC5D,IAAI,QAAQ,GAAG;gBACf,IAAI,QAAQ,GAAG,IAAI,QAAQ,CAAC,OAAO,CAAC,SAAS,KAAI,eAAe;gBAChE,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;YAC/B;YAEA,4BAA4B;YAC5B,IAAI,UAAU,IAAI,CAAC,CAAA,QAAS,IAAI,QAAQ,CAAC,UAAU,CAAC,SAAS;gBAC3D,IAAI,QAAQ,GAAG;gBACf,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;YAC/B;YAEA,yDAAyD;YACzD,MAAM,sBAAsB;gBAAC;gBAAK;gBAAY;gBAAa;gBAAU;gBAAY;aAAO;YACxF,IAAI,CAAC,oBAAoB,IAAI,CAAC,CAAA,OAAQ,IAAI,QAAQ,CAAC,UAAU,CAAC,QAAQ;gBACpE,wBAAwB;gBACxB,IAAI,QAAQ,GAAG;gBACf,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;YAC/B;YACA;QAEF,KAAK;YACH,uBAAuB;YACvB,MAAM,mBAAmB;gBAAC;gBAAK;gBAAU;gBAAW;gBAAW;gBAAoB;gBAAmB;aAAO;YAC7G,IAAI,CAAC,iBAAiB,IAAI,CAAC,CAAA,OAAQ,IAAI,QAAQ,CAAC,UAAU,CAAC,QAAQ;gBACjE,6BAA6B;gBAC7B,IAAI,QAAQ,GAAG;gBACf,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;YAC/B;YACA;QAEF,KAAK;YACH,oBAAoB;YACpB,mDAAmD;YACnD,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;QAE1B;YACE,+BAA+B;YAC/B,IAAI,QAAQ,GAAG;YACf,IAAI,QAAQ,GAAG;YACf,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;IACjC;IAEA,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;KAKC,GACD;KACD;AACH"}}]
}